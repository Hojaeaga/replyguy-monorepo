---
description: 
globs: 
alwaysApply: true
---
We need to follow the following project structure:

Hereâ€™s a **complete, copy-paste-ready monorepo layout** for ReplyGuy, presented entirely in Markdown.

---

## ğŸ“ Directory tree

<details>
<summary>Click to expand</summary>

```text
.
â”œâ”€â”€ README.md
â”œâ”€â”€ turbo.json
â”œâ”€â”€ package.json
â”œâ”€â”€ .env.example
â”œâ”€â”€ .gitignore
â”‚
â”œâ”€â”€ apps/                              # â†’ Deployable runtime services
â”‚   â”œâ”€â”€ ingestion/                     # 1ï¸âƒ£ Webhook intake â†’ queue
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ Dockerfile
â”‚   â”‚
â”‚   â”œâ”€â”€ worker/                        # 2ï¸âƒ£ Queue worker â†’ OpenAI etc.
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ Dockerfile
â”‚   â”‚
â”‚   â””â”€â”€ web/                           # 3ï¸âƒ£ Next.js 14 (mini-app-ready)
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ app/
â”‚       â”‚   â”‚   â””â”€â”€ page.tsx
â”‚       â”‚   â””â”€â”€ components/
â”‚       â”œâ”€â”€ miniapp.json               # Farcaster Mini-App manifest
â”‚       â”œâ”€â”€ next.config.js
â”‚       â”œâ”€â”€ tailwind.config.ts
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ packages/                          # â†’ Re-usable, side-effect-free libs
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ src/                       # Types, logger, errors
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ src/                       # Supabase typed queries
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ queue/
â”‚   â”‚   â”œâ”€â”€ src/                       # Redis/SQS abstraction
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ farcaster-adapter/
â”‚   â”‚   â”œâ”€â”€ src/                       # Neynar I/O & trending cache
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ openai/
â”‚   â”‚   â”œâ”€â”€ src/                       # Cost-controlled chat/embeddings
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ src/                       # shadcn/Tailwind components
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ config/                        # Shared tooling presets
â”‚       â”œâ”€â”€ eslint/
â”‚       â”‚   â””â”€â”€ index.js
â”‚       â”œâ”€â”€ prettier/
â”‚       â”‚   â””â”€â”€ .prettierrc.js
â”‚       â”œâ”€â”€ tsconfig/
â”‚       â”‚   â””â”€â”€ base.json
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ infra/                             # IaC (Terraform / CDK, per env)
â”‚   â””â”€â”€ terraform/
â”‚       â””â”€â”€ main.tf
â”‚
â”œâ”€â”€ scripts/                           # One-off dev & ops helpers
â”‚   â””â”€â”€ dev.sh
â”‚
â””â”€â”€ .github/
    â””â”€â”€ workflows/
        â””â”€â”€ ci.yml                     # Lint â†’ test â†’ build â†’ docker
```

</details>

---

## ğŸ—‚ï¸ Top-level files

| File / Dir       | Purpose                                                      |
| ---------------- | ------------------------------------------------------------ |
| **turbo.json**   | Turborepo pipeline & cache rules (dev, build, test, docker). |
| **package.json** | Root scripts (`turbo run â€¦`) plus workspace map.             |
| **.env.example** | Canonical list of env vars; never commit secrets.            |
| **README.md**    | Quick-start, architecture diagram, dev commands.             |

---

## ğŸ”Œ `apps/*` (deployable services)

| Folder        | Runtime        | Brief description                                                                |
| ------------- | -------------- | -------------------------------------------------------------------------------- |
| **ingestion** | Node + Express | Verifies Neynar webhook â†’ pushes job into queue.                                 |
| **worker**    | Node           | Stateless worker: fetches job â†’ embeddings, OpenAI, similarity search â†’ replies. |
| **web**       | Next .js 14    | Operator dashboard **and** Farcaster Mini-App UI (via `miniapp.json`).           |

---

## ğŸ“¦ `packages/*` (shared libraries)

| Package               | Highlights                                                             |
| --------------------- | ---------------------------------------------------------------------- |
| **core**              | Zod types, pino logger, custom errors.                                 |
| **db**                | Supabase client with typed queries & migrations.                       |
| **queue**             | Thin wrapper around Redis Streams **or** AWS SQS; interchangeable.     |
| **farcaster-adapter** | Neynar API, trending-cast cache, `postReply()`.                        |
| **openai**            | GPT client with token counting & cost caps; memoized embeddings.       |
| **ui**                | shadcn + Tailwind components reused by Next.js pages.                  |
| **config**            | Central ESLint, Prettier, TS configs so every workspace stays aligned. |

---

## âš™ï¸ CI / CD

* **GitHub Actions** in `.github/workflows/ci.yml`.
  Steps: checkout â†’ pnpm install â†’ `turbo build` (leveraging remote cache) â†’ unit tests â†’ optionally build & push Docker images.

---

### ğŸ Ready to run locally

```bash
pnpm install
pnpm dev           # turbo run dev â†’ launches all apps in watch-mode

# Or, with Docker Compose
docker compose up  # brings up Redis, Supabase-local, workers, web
```

Thatâ€™s the full scaffoldâ€”ready for you to drop code into each service or package and hit the ground running.
